import{d as h,r as c,L as C,o as q,I as g,E as p,k as U,e as A,g as l,w as o,i as r,l as B,f as w,h as _,_ as E}from"./index-CtaRNcZl.js";const I={class:"register-container"},N={class:"tips"},L=h({__name:"AdminRegister",setup(M){const i=U(),f=c(),u=c(!1),a=C({username:"",email:"",full_name:"",password:""}),V={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码至少6位",trigger:"blur"}]},y=async()=>{var t,e;try{await f.value.validate(),u.value=!0,await g.post("/api/admin/register",{username:a.username,email:a.email,full_name:a.full_name||void 0,password:a.password,is_superuser:!0}),p.success("注册成功，请登录"),i.push("/admin/login")}catch(m){p.error(((e=(t=m.response)==null?void 0:t.data)==null?void 0:e.detail)||"注册失败")}finally{u.value=!1}},b=()=>{i.push("/admin/login")};return q(async()=>{var t;try{(t=(await g.get("/api/admin/can-register")).data)!=null&&t.can_register||(p.warning("已存在管理员，请联系超级管理员添加账号"),i.push("/admin/login"))}catch{}}),(t,e)=>{const m=r("el-alert"),d=r("el-input"),n=r("el-form-item"),v=r("el-button"),k=r("el-link"),x=r("el-form"),R=r("el-card");return B(),A("div",I,[l(R,{class:"register-card"},{header:o(()=>[...e[4]||(e[4]=[w("h2",null,"AI小说平台 - 管理员注册",-1)])]),default:o(()=>[l(m,{title:"提示：仅当系统没有任何管理员时允许注册。若已存在管理员，请联系超级管理员添加账号。",type:"info","show-icon":"",class:"mb-16"}),l(x,{model:a,rules:V,ref_key:"formRef",ref:f,"label-width":"80px"},{default:o(()=>[l(n,{label:"用户名",prop:"username"},{default:o(()=>[l(d,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=s=>a.username=s),placeholder:"用户名"},null,8,["modelValue"])]),_:1}),l(n,{label:"邮箱",prop:"email"},{default:o(()=>[l(d,{modelValue:a.email,"onUpdate:modelValue":e[1]||(e[1]=s=>a.email=s),placeholder:"邮箱"},null,8,["modelValue"])]),_:1}),l(n,{label:"姓名",prop:"full_name"},{default:o(()=>[l(d,{modelValue:a.full_name,"onUpdate:modelValue":e[2]||(e[2]=s=>a.full_name=s),placeholder:"姓名（可选）"},null,8,["modelValue"])]),_:1}),l(n,{label:"密码",prop:"password"},{default:o(()=>[l(d,{modelValue:a.password,"onUpdate:modelValue":e[3]||(e[3]=s=>a.password=s),type:"password",placeholder:"至少6位","show-password":""},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[l(v,{type:"primary",loading:u.value,onClick:y,style:{width:"100%"}},{default:o(()=>[...e[5]||(e[5]=[_("注册管理员",-1)])]),_:1},8,["loading"])]),_:1}),w("div",N,[e[7]||(e[7]=_(" 已有账号？",-1)),l(k,{type:"primary",onClick:b},{default:o(()=>[...e[6]||(e[6]=[_("返回登录",-1)])]),_:1})])]),_:1},8,["model"])]),_:1})])}}}),j=E(L,[["__scopeId","data-v-949fcd35"]]);export{j as default};
